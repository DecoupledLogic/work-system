# Work Item Directory Schema

Defines the structure and contents of work item directories in `work-items/`.

## Overview

Each work item gets a dedicated directory that serves as its "structured home" containing all related artifacts, activity history, and notes. This consolidates context that would otherwise be scattered across category folders.

## Directory Naming

Format: `{prefix}-{id}` (lowercase)

| Prefix | External System | Example |
|--------|-----------------|---------|
| `tw` | Teamwork | `tw-26253606` |
| `gh` | GitHub | `gh-456` |
| `ado` | Azure DevOps | `ado-123` |
| `wi` | Internal (no external system) | `wi-001` |

## Directory Structure

```text
work-items/{prefix}-{id}/
├── work-item.yaml           # Required: Metadata snapshot
├── activity-log.md          # Required: Cross-session history (tracked)
├── session-notes.md         # Optional: Personal notes (gitignored)
├── prd.md                   # Optional: Product requirements
├── spec.md                  # Optional: Technical specification
├── impl-plan.md             # Optional: Implementation plan
├── test-plan.md             # Optional: Test strategy
├── bug-report.md            # Optional: Bug documentation
├── spike-report.md          # Optional: Research findings
├── delivery-plan.md         # Optional: Multi-story delivery plan
├── estimate.csv             # Optional: Hour breakdown
├── adr/                     # Optional: Work-item-specific ADRs
│   └── NNN-title.md
└── research/                # Optional: Supporting research
    └── *.md
```

## File Schemas

### work-item.yaml (Required)

Metadata snapshot synchronized from the work item schema.

```yaml
# Identity
id: string                    # Directory name (e.g., "tw-26253606")
name: string                  # Work item title
externalSystem: string        # teamwork | github | ado | internal
externalId: string            # ID in external system
externalUrl: string | null    # Direct link to external system

# Classification
type: enum                    # epic | feature | story | task | bug | spike
status: enum                  # draft | triaged | planned | designed | in_progress | review | done
stage: enum                   # triage | plan | design | deliver | eval
queue: enum                   # immediate | urgent | standard | deferred

# Tracking
createdAt: datetime           # When work item was created
initializedAt: datetime       # When directory was created
updatedAt: datetime           # Last modification
```

**Example:**

```yaml
id: tw-26253606
name: Subscription Renewal System
externalSystem: teamwork
externalId: "26253606"
externalUrl: https://company.teamwork.com/tasks/26253606
type: epic
status: in_progress
stage: design
queue: standard
createdAt: 2025-12-01T10:00:00Z
initializedAt: 2025-12-09T14:30:00Z
updatedAt: 2025-12-10T09:15:00Z
```

### activity-log.md (Required, Tracked)

High-level, team-facing history of significant events across sessions.

**Purpose:** Answer "What has been done on this work item?" for team handoffs and context recovery.

**Content Guidelines:**

- Keep entries concise and team-relevant
- Focus on stage transitions, artifacts, and decisions
- Avoid verbose session details (those go in session-notes.md)
- List artifacts created at each stage
- Note key decisions and their rationale

**Structure:**

```markdown
# Activity Log: {id}

## Summary

| Metric | Value |
|--------|-------|
| Initialized | {date} |
| Current Stage | {stage} |
| Artifacts | {count} |

---

## Timeline

### {date} - {Stage} Stage

- {Summary of work done}
- **Artifacts:** {list of files created}
- **Decision:** {key decision if any}

### {date} - Initialized

- Created from {external system} {type} {externalId}
- Type: {type}, Queue: {queue}
```

### session-notes.md (Optional, Gitignored)

Personal scratch notes for the current developer.

**Purpose:** Capture thinking, questions, and verbose details not suitable for team history.

**Content Guidelines:**

- Session-specific exploration notes
- Questions to resolve
- Debugging observations
- Personal todos and reminders
- Verbose details that don't belong in activity-log.md

**Structure:**

```markdown
# Session Notes: {id}

## {date} {session-id}

### {Topic}

- {notes}

### Questions to resolve

- [ ] {question}
```

### Document Files (Optional)

Standard documents generated by the document-writer agent:

| File | Template | Purpose |
|------|----------|---------|
| `prd.md` | `prd` | Product requirements |
| `spec.md` | `spec` | Technical specification |
| `impl-plan.md` | `impl-plan` | Implementation plan |
| `test-plan.md` | `test-plan` | Test strategy |
| `bug-report.md` | `bug-report` | Bug documentation |
| `spike-report.md` | `spike-report` | Research findings |
| `delivery-plan.md` | `delivery-plan` | Multi-story delivery |

### adr/ Subdirectory (Optional)

Work-item-specific architecture decision records.

**Naming:** `NNN-short-title.md` (e.g., `001-api-approach.md`)

**Purpose:** Decisions that are specific to this work item and don't belong in global ADRs.

### research/ Subdirectory (Optional)

Supporting research and reference documents.

**Purpose:** Background research, API documentation, competitor analysis, etc.

## Lifecycle

### Initialization

Triggered during `/triage` stage:

1. Create directory `work-items/{prefix}-{id}/`
2. Write `work-item.yaml` with initial metadata
3. Write `activity-log.md` with initialization entry
4. Optionally create `session-notes.md`

### During Work

As work progresses:

1. Stage agents append to `activity-log.md` at stage start/complete
2. Document writer creates document files (prd.md, spec.md, etc.)
3. Developer may use `session-notes.md` for personal notes
4. `work-item.yaml` updated when status/stage changes

### Completion

When work item reaches `done` status:

1. Final activity log entry with completion summary
2. Optionally archive to `work-items/.archive/`

## Git Behavior

```gitignore
# Tracked (team-facing)
work-items/*/work-item.yaml
work-items/*/activity-log.md
work-items/*/*.md (documents)
work-items/*/adr/
work-items/*/research/

# Ignored (personal)
work-items/*/session-notes.md
```

## Relationship to Other Schemas

| Schema | Relationship |
|--------|--------------|
| `work-item.schema.md` | `work-item.yaml` is a snapshot of WorkItem fields |
| `document.schema.md` | Document files follow document template schemas |
| `external-system.schema.md` | Prefix and externalId come from external system |

## Related Files

- [ADR-0006: Work Item Directories](../docs/adrs/0006-work-item-directories.md)
- [Implementation Plan](../docs/plans/work-item-directories-plan.md)
- Templates: `templates/work-item-init/`
